## Traffic Lane Recognition using Edge Detection and the Hough Transform
Traffic lane markings can be detected from image or video capture. Below is a typical implementation, where the overlaid white lines have been generated by the algorithm described below and in further detail at [www.lrgonzales.com/traffic-lane-recognition](http://www.lrgonzales.com/traffic-lane-recognition).

<p align="center">
  <img src="https://user-images.githubusercontent.com/4633154/38846095-7fe42122-41c8-11e8-9755-01c13528094b.jpg" width="480px" height="270px"/>
</p>

### Algorithm
The algorithm has three steps, summarized below.

* Color enhancement and grayscale conversion
* Edge detection
* Hough transform for linear feature identification

To aid edge detection, pixels in the image that can be considered yellow or white were enhanced (overwritten to pure white). The Boolean masking was achieved by converting the input from RGB colorspace to HSL colorspace and setting pixels that are within a predefined HSL range to pure white.

The Canny edge detector, `cv2.Canny`, was chosen for edge detection, particularly because edges in the input image are reduced to single-pixel width lines, a useful feature for the subsequent Hough transform processing. The Hough transform, `cv2.HoughLinesP`, then evaluates these identified edges pixel-by-pixel and extracts lines (lane marking) according to specific input parameters.

To gain experience with the implementation details of edge detection and the Hough transform, I implemented my own methods (`src/edge_det.py` and `src/hough.py`). Edge detection proved to be a very mechanical process, where kernel convolution produced horizontal and vertical gradients and these gradients were then combined with non-maximum suppression and thresholding to produce an output image. On the other hand, the Hough transform was challenging to implement in a computationally-efficient manner. Ultimately, I implemented a variation of the [Progressive Probabilistic Hough Transform](http://cmp.felk.cvut.cz/~matas/papers/matas-bmvc98.pdf).

### Usage
The program can be performed on a `jpg` or `mp4` file from the `input` directory by executing `python lane_recog.py input/<file>` where `<file>` is the desired input.

`lane_recog.py` does not make use of `src/edge_det.py` or `src/hough.py`. The `cv2.HoughLinesP` usage in `lane_recog.py` can be replaced with the method in `src/hough.py`, but `src/edge_det.py` is not recommended for usage because it does not perform hysteresis thresholding.

### Improvements
Throughout the design, it became apparent that the methods used relied on a fairly smooth road, free of obstacles and relatively free of debris. For this reason, the input was preprocessed with a Gaussian blur. However, a Gaussian blur may not be enough for some unusual road surfaces or when obstacles or large debris are present. The danger is that these features could be mistaken for a lane in the algorithm. More advanced techniques, such as convolutional neural networks, could be more robust to such non-idealities.

The `src/hough.py` implementation of the Hough transform could benefit from an accumulator not implemented as a `list`. Doing so would likely result in on-par performance to the OpenCV implementation.

### Dependencies
`lane_recog.py` makes use of `numpy`, `matplotlib`, `cv2`, and `moviepy` (for `.mp4` input files).
